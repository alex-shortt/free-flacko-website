function initImageGlitch(){jQuery.fn.noisy=function(e){e=jQuery.extend({},jQuery.fn.noisy.defs,e);var t=this,o=[{x:0,y:0},{x:0,y:0},{x:0,y:0}],a=jQuery(this),n=[Math.random()+1,Math.random()+1,Math.random()+1],i=[0,0,0],s=0,r=[],l=null,c=e.rows,d=e.ratio,p=e.img,h=!1,m=e.id;this.run=function(){var e;for(e=0;e<3;e++)n[e]>=1&&(--n[e],i[e]=Math.random()/4+.03),n[e]+=i[e],s+=.25*(38-s),o[e].x=Math.ceil(Math.sin(n[e]*Math.PI*2)*i[e]*s*2),o[e].y=0;var t=(Math.abs(o[0].x)+Math.abs(o[1].x)+Math.abs(o[2].x)+8)/4;for(e=c;e-=1;){var a=.8*Math.sin(e/c*Math.PI*(Math.random()/8+1))*t*t;r[e].css({transform:"translateZ(0) translate3d(0, 0, 0) translateX("+a+"px)",webkitTransform:"translateZ(0) translate3d(0, 0, 0) translateX("+a+"px)"})}},this.go=function(){h=!0,clearInterval(l),l=setInterval(this.run,30)},this.pause=function(){h=!1,clearInterval(l),l=null;for(var e=0;e<c;e++)r[e].css({transform:"translateZ(0) translate3d(0, 0, 0)",webkitTransform:"translateZ(0) translate3d(0, 0, 0)"})},this.updateContainerBounds=function(){var e=$(m).outerWidth(),t=$(m).outerHeight();if(d<t/e){var o=e*d;a.css({height:o+"px",padding:(t-o)/2+"px 0px"})}else{var n=t/d;a.css({height:t+"px",padding:"0px "+(e-n)/2+"px"})}},this.changeImage=function(e){var t=$(m).outerWidth(),o=$(m).outerHeight(),n=new Image;n.onload=function(){d=this.height/this.width;for(var n=0;n<c;n++)a.find("div").eq(n).css({backgroundImage:"url("+e+")"});if(d<o/t){var i=t*d;a.css({height:i+"px",padding:(o-i)/2+"px 0px"})}else{var s=o/d;a.css({height:o+"px",padding:"0px "+(t-s)/2+"px"})}},n.src=e},a.css({position:"relative",padding:"0px calc((430px - "+430*d+"px) / 2)"});for(var u=0;u<c;u++){var f=100*u/c+"%";a.append("<div></div>"),a.find("div").eq(u).css({backgroundImage:"url("+p+")",backgroundPosition:"0px "+("0%"==f?"0.2%":f),backgroundSize:"cover",width:"100%",flex:"1",cursor:"pointer",transform:"translateZ(0) translate3d(0, 0, 0)",webkitTransform:"translateZ(0) translate3d(0, 0, 0)"}),r.push(a.find("div").eq(u))}return e.auto&&setInterval(function(){h||(t.go(),setTimeout(t.pause(),e.delay/2*Math.random()))},e.delay),this.initialize=function(){return this},this.initialize()},jQuery.fn.noisy.defs={rows:0,ratio:1,img:"",auto:!1,delay:7e3}}function initModal(){$(".modal-open").on("click",function(e){var t=$(this),o=$(t).data("modal");$(o).parents(".modal-overlay").addClass("modal-opened"),setTimeout(function(){$(o).addClass("modal-opened")},350),$(document).on("click",function(e){var t=$(e.target);$(t).hasClass("modal-overlay")&&($(t).find(".modal-modal").each(function(){$(this).removeClass("modal-opened")}),setTimeout(function(){$(t).removeClass("modal-opened")},350))})}),$(".modal-close").on("click",function(e){e.preventDefault(),e.stopImmediatePropagation;var t=$(this),o=$(t).data("modal");$(o).removeClass("modal-opened"),setTimeout(function(){$(o).parents(".modal-overlay").removeClass("modal-opened")},350)})}function openModal(e){-1==e.indexOf("#")&&(e="#"+e),$(e).parents(".modal-overlay").addClass("modal-opened"),setTimeout(function(){$(e).addClass("modal-opened")},350),$(document).on("click",function(e){var t=$(e.target);$("#model-modal").hasClass("modal-opened")||$(t).hasClass("modal-overlay")&&($(t).find(".modal-modal").each(function(){$(this).removeClass("modal-opened")}),setTimeout(function(){$(t).removeClass("modal-opened")},350))})}function closeModal(e){-1==e.indexOf("#")&&(e="#"+e),$(e).removeClass("modal-opened"),setTimeout(function(){$(e).parents(".modal-overlay").removeClass("modal-opened")},350)}function isSafari(){var e=navigator.userAgent.toLowerCase();if(-1!=e.indexOf("safari"))return!(e.indexOf("chrome")>-1)}function turnScreenOn(e){isSafari()?$(".awge-content").css("-webkit-animation","turn-on-safari "+e+"s linear"):$(".awge-content").css("animation","turn-on "+e+"s linear")}function turnScreenOff(e){isSafari()?$(".awge-content").css("-webkit-animation","turn-off-safari "+e+"s linear forwards"):$(".awge-content").css("animation","turn-off "+e+"s linear forwards")}function notify(e){$("#notify-message").text(e.toUpperCase()),openModal("notify-modal")}function startTextGlitch(){$(".shop-glitch-placeholder").addClass("shop-glitch")}function stopTextGlitch(){$(".shop-glitch-placeholder").removeClass("shop-glitch")}function initTerms(){$(".awge-terms").on("click",function(){window.location.hash="terms"}),$(".awge-privacy").on("click",function(){window.location.hash="privacy"})}function printCredits(){}function isMobileView(){return window.matchMedia(smartphones).matches}function getParameterByName(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var o=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),a=o.exec(t);return a?a[2]?decodeURIComponent(a[2].replace(/\+/g," ")):"":null}function shopLoad(){$("#shop-option-awge").click(function(){}),$("#shop-option-tstng").click(function(){window.open("https://tstng.co/store.html")}),$("#shop-item-decrease").click(function(){changeShopPage(-1)}),$("#shop-item-increase").click(function(){changeShopPage(1)}),$("#shop-buy-button").click(function(){isOutOfStock(shop[currentItem.index].baseSKU+"-"+currentItem.size)||addToCart()}),$("#cart-checkout").click(function(){cleanCart(),0!=Object.keys(getCart()).length&&(closeModal("cart-modal"),openCheckoutLink())}),$(".shop-items-item").click(function(){null!=shop[currentItem.index].camera&&(loadModel(shop[currentItem.index].filename,shop[currentItem.index].camera),openModal("model-modal"));var e="Sold Out"==shop[currentItem.index].price?"Sold Out":"$"+shop[currentItem.index].price;$("#model-price").text(e)});var e=new Image;e.onload=function(){$("#shop-item").html(""),noise=$("#shop-item").noisy({rows:30,img:resolveImgURL(shop[1].filename),ratio:this.height/this.width,id:"#shop-item"}),window.addEventListener("resize",function(){noise.updateContainerBounds()}),$("#shop-item-mobile").css("background-image","url("+resolveImgURL(shop[1].filename)),setShopProduct(1)},e.src=resolveImgURL(shop[1].filename),refreshCart()}function resolveImgURL(e){return"https://dwvo2npct47gg.cloudfront.net/gifs/"+e+".gif"}function setShopProduct(e){null==shop[e]&&(e=1);var t=$("#shop-item-price"),o=$("#shop-item-name"),a=$("#shop-item-progress"),n=$("#shop-item-image"),i=$("#shop-items-message"),s=Object.keys(shop).length;noise.go(),startTextGlitch(),$("#shop-item-mobile").css("background-image","url("+resolveImgURL(shop[e].filename)+")"),setTimeout(function(){noise.changeImage(resolveImgURL(shop[e].filename)),$(a).html(e+"/"+s).attr("data-text",e+"/"+s);var r="Sold Out"==shop[e].price?"Sold Out":"$"+shop[e].price;$(t).html(r).attr("data-text",r).data(r),$(i).html(shop[e].message),$(n).prop("src",resolveImgURL(shop[e].filename)),$(o).html(shop[e].name).attr("data-text",shop[e].name).data(shop[e].name),currentItem.index=e,resetSizes(),setTimeout(function(){noise.pause(),stopTextGlitch()},400)},400)}function changeShopPage(e){var t=Object.keys(shop).length,o=parseInt(currentItem.index)+e;o>t?o=1:o<1&&(o=t),setShopProduct(o)}function closeSizes(e){var t=$(".shop-size-wrapper"),o=$(".shop-items-options-middle");$(t).html(""),null==e?($(t).append('<h1 onclick="openSizes()" class="shop-item-option shop-size-button">SIZE</h1>'),currentItem.size=null):($(t).append('<h1 onclick="openSizes()" id="shop-size-final" class="shop-item-option shop-size-button">'+e+"</h1>"),currentItem.size=e),updateBuyButton(),$(o).css("width","auto"),$(o).removeClass("shop-items-options-middle-open")}function openSizes(){var e=$(".shop-size-wrapper"),t=$(".shop-items-options-middle"),o=currentItem.index,a=Object.keys(shop[o].sizes).length;$(e).html("");for(var n=0;n<a;n++){var i=shop[o].sizes[n];isOutOfStock(shop[o].baseSKU+"-"+i)?$(e).append('<h1 class="shop-item-option shop-size-option shop-size-option-disabled">'+i+"</h1>"):$(e).append("<h1 onclick=\"closeSizes('"+i+'\')" class="shop-item-option shop-size-option">'+i+"</h1>")}$(t).css("width",$(t).width()),$(t).animate({width:"100%"},250),$(t).addClass("shop-items-options-middle-open")}function resetSizes(){closeSizes();var e=$(".shop-size-wrapper"),t=$(".shop-items-options-middle");$(e).html(""),$(t).removeClass("shop-items-options-middle-open"),null==shop[currentItem.index].sizes?($(e).css("display","none"),currentItem.size="OS",updateBuyButton()):($(e).css("display","flex"),$(e).append('<h1 onclick="openSizes()" class="shop-item-option shop-size-button">SIZE</h1>'),currentItem.size=null)}function getCart(){try{return null==localStorage.cart?{}:JSON.parse(localStorage.cart)}catch(e){return console.log("Error Getting Cart - Emptying...  :: "+e),localStorage.cart="{}",JSON.parse(localStorage.cart)}}function cleanCart(){var e=getCart();if(0!=Object.keys(e).length){for(var t=Object.keys(e).length-1;t>=0;t--){for(var o=Object.keys(e)[t],a=o.substring(0,o.lastIndexOf("-")),n=!1,i=1;i<=Object.keys(shop).length;i++)if(shop[i].baseSKU==a){n=!0;break}n||delete e[o]}localStorage.cart=JSON.stringify(e)}}function refreshCart(){cleanCart();var e=$("#cart-container");$(e).html("");for(var t=getCart(),o=0;o<Object.keys(t).length;o++){var a=Object.keys(t)[o],n=a.substring(0,a.lastIndexOf("-")),i=-1;if(0!=t[a]){for(var s=1;s<=Object.keys(shop).length;s++)if(shop[s].baseSKU==n){i=s;break}var r=shop[i],l=a.split("_")[a.split("_").length-1];$(e).append("<div id="+a+' class="cart-item">                         <div class="cart-item-delete-wrapper">                            <h1 class="cart-item-delete" onclick="removeFromCart(\''+a+'\')">X</h1>                        </div>                        <div class="cart-item-image" style="background-image: url(\''+resolveImgURL(r.filename)+'\')"></div>                        <div class="cart-item-name-wrapper">                            <h1 class="cart-item-name">'+r.name+("OS"==l?"":" - SZ "+l)+'</h1>                        </div>                        <div class="cart-item-quantity-wrapper">                            <h1 class="cart-item-quantity">'+t[a]+'</h1>                        </div>                        <div class="cart-item-price-wrapper">                            <h1 class="cart-item-price">$'+parseFloat(r.price)*parseFloat(t[a])+"</h1>                        </div>                    </div>")}}""==$(e).html()&&$(e).append('<div class="cart-items-text">YOUR CART IS EMPTY...</div>'),localStorage.cart=JSON.stringify(t)}function addToCart(){if(null==currentItem.size)return void console.log("Add to cart failed :: No Size");var e=shop[currentItem.index].baseSKU,t=currentItem.size,o=(shop[currentItem.index],e+"-"+t),a=getCart();null==a[o]&&(a[o]=0),a[o]++,localStorage.cart=JSON.stringify(a),refreshCart(),openModal("cart-modal")}function removeFromCart(e){var t=getCart();delete t[e],localStorage.cart=JSON.stringify(t),refreshCart()}function isOutOfStock(e){return null==skuMatch[e]||!skuMatch[e].available}function updateBuyButton(){var e=$("#shop-buy-button"),t=$("#shop-size-button");$(e).removeClass("shop-buy-button-disabled"),$(t).removeClass("shop-size-button-disabled"),$(e).text("Buy"),currentItem.index||(currentItem.index=1);var o=shop[currentItem.index],a=o.sizes,n=o.baseSKU;if(null!=currentItem.index)if(null==a&&isOutOfStock(n+"-"+currentItem.size))$(t).addClass("shop-size-button-disabled"),$(e).addClass("shop-buy-button-disabled"),$(e).text("Sold Out");else if(null!=a&&null==currentItem.size){for(var i=!0,s=0;s<a.length;s++){var r=a[s];if(!isOutOfStock(n+"-"+r)){i=!1;break}}i&&($(t).addClass("shop-size-button-disabled"),$(e).addClass("shop-buy-button-disabled"),$(e).text("Sold Out"))}}function openCheckoutLink(){var e=getCart();shopClient.checkout.create().then(function(t){for(var o=[],a=0;a<Object.keys(e).length;a++){var n=Object.keys(e)[a],i=skuMatch[n];o.push({variantId:i.id,quantity:e[n]})}shopClient.checkout.addLineItems(t.id,o).then(function(e){console.log("checkout"),console.log(e),localStorage.cart="dicks",refreshCart(),window.location=e.webUrl})})}function getCartSubtotal(){for(var e=getCart(),t=0,o=0;o<Object.keys(e).length;o++){var a=Object.keys(e)[o],n=a.split("-")[0],i=a.split("-")[1],s=(a.split("-")[2],shop[n][i]);null==s&&(e[a]=0),t+=parseFloat(s.price)*parseFloat(e[a])}return t}function initShopify(){fetch("https://awge-2018.myshopify.com/api/2019-07/graphql.json",{method:"POST",headers:{"Content-Type":"application/graphql","X-Shopify-Storefront-Access-Token":"c93be35bf35584f666b857f0747fa13d"},body:'{ productByHandle(handle: "free-rocky-tee") {                 variants(first: 10) { edges { node {                   title                   sku                   price                   availableForSale                 } } }             } }'}).then(function(e){return e.json()}).then(function(e){console.log("data",e);for(var t=e.data.productByHandle,o=t.variants.edges,a=0;a<o.length;a++)o[a].node.availableForSale&&(skuMatch[o[a].node.sku]="notnull");console.log(skuMatch),updateBuyButton()})}function initModel(e){var t=window.innerWidth,o=window.innerHeight;scene=new THREE.Scene,camera=new THREE.PerspectiveCamera(75,t/o,.1,1e3),renderer=new THREE.WebGLRenderer({alpha:!0});new THREE.JSONLoader;renderer.setSize(t,o),renderer.setClearColor(0,0),$(e).append(renderer.domElement);var a=new THREE.AmbientLight(14737632);scene.add(a),camera.position.z=5,controls=new THREE.OrbitControls(camera,renderer.domElement),controls.enablePan=!1,window.addEventListener("resize",function(){var e=window.innerWidth,t=window.innerHeight;renderer.setSize(e,t),camera.aspect=e/t,camera.updateProjectionMatrix()})}function animateModel(){requestAnimationFrame(animateModel),renderer.render(scene,camera),controls.update()}function setCameraPosition(e,t,o){camera.position.x=e,camera.position.y=t,camera.position.z=o}function animateModelLoading(){var e="Loading",t=($("#model-loading").text().match(/\./g)||[]).length;++t>3&&(t=1);for(var o=0;o<t;o++)e+=".";$("#model-loading").text(e)}function showModelLoading(){return $("#model-loading").animate({opacity:1},1e3),setInterval(animateModelLoading,400)}function hideModelLoading(e){$("#model-loading").animate({opacity:0},750),setTimeout(function(){clearInterval(e)},1e3)}function loadModel(e,t){var o=function(e){if(e.lengthComputable){var t=e.loaded/e.total*100;console.log(Math.round(t,2)+"% downloaded")}},a=function(e){};null!=object&&scene.remove(object);var n=showModelLoading(),i=new THREE.MTLLoader;i.setPath("./awge-media/models/"),i.load(e+".mtl",function(i){i.preload();var s=new THREE.OBJLoader;s.setMaterials(i),s.setPath("https://dwvo2npct47gg.cloudfront.net/models/"),s.load(e+".obj",function(e){hideModelLoading(n),setTimeout(function(){object=e,object.position.y=0,object.rotation.x=0,setCameraPosition(t.pos[0],t.pos[1],t.pos[2]),controls.minDistance=t.minDist,controls.maxDistance=t.maxDist,t.scale&&object.scale.set(t.scale,t.scale,t.scale),scene.add(object)},750)},o,a)})}var noise,smartphones="screen and (max-width: 480px) and (orientation: portrait), screen and (max-height: 480px) and (orientation: landscape)",currentItem={};$(document).on("click",function(e){var t=$(e.target),o=$(".shop-items-options-middle");$(o).hasClass("shop-items-options-middle-open")&&($(t).hasClass("shop-items-options-middle")||$(t).hasClass("shop-size-wrapper")||$(t).hasClass("shop-item-option")||closeSizes(currentItem.size))});var checkoutShipping,checkoutEmail,orderData,shopClient,skuMatch={},scene,camera,renderer,controls,object;